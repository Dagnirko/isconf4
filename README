
Requires python 2.2 or later -- 2.2 support will soon be deprecated in
favor of 2.3 or later.

See the man page for more details of, for instance, the contents of
/var/is/conf/domain.


Install:
========

cd /tmp
tar -xzvf isconf-4.2.6.tar.gz
cd isconf-4.2.6
make install
cp etc/rc.isconf /etc/init.d/isconf
(make symlink(s) from /etc/rc*)
(create /etc/is/main.cf)
chmod 755 /usr/bin/isconf
mkdir -p /var/is/conf
echo yourdomain.com > /var/is/conf/domain
isconf start
isconf up

Upgrade from versions more recent than 4.2.6pre.133:
====================================================

newversion=isconf-4.2.6.N
cd /tmp
isconf -m "upgrade to $newversion" lock
isconf snap $newversion.tar.gz
isconf exec tar -xzvf $newversion.tar.gz
cd $newversion
isconf exec make install
isconf exec cp etc/rc.isconf /etc/init.d/isconf
(...and make /etc/rc* symlinks, again using isconf exec)
isconf exec chmod 755 /usr/bin/isconf
isconf reboot
isconf ci


Upgrade from <= 4.2.6pre.133:
=============================

domain=foo.com
newversion=isconf-4.2.6.N
isconf -m "upgrade to $newversion" lock
# migrate to new config pathname
isconf exec mkdir /etc/is
isconf exec ln /etc/is.conf /etc/is/main.cf
# migrate to new var tree
isconf exec mkdir /var/is
cd /var/is
isconf exec sh -c "mv /var/isconf conf && ln -s /var/is/conf /var/isconf"
isconf exec sh -c "mv /var/isfs fs && ln -s /var/is/fs /var/isfs"
# fix domain dirname
cd /var/is/fs/cache/
isconf exec sh -c "mv localdomain $domain && ln -s $domain localdomain"
cd /var/is/fs/private/
isconf exec sh -c "mv localdomain $domain && ln -s $domain localdomain"
# create domain config
echo $domain > /var/is/conf/domain
isconf snap /var/is/conf/domain
# install
cd /tmp
isconf snap $newversion.tar.gz
isconf exec tar -xzvf $newversion.tar.gz
cd $newversion
isconf exec make install
isconf exec cp etc/rc.isconf /etc/init.d/isconf
isconf exec chmod 755 /usr/bin/isconf
isconf reboot
# cleanup and ci
isconf exec rm /etc/is.conf
isconf exec rm /var/isconf  # skip this if 4.1.7 is still running
isconf exec rm /var/isfs
isconf exec rm /var/is/fs/private/localdomain
isconf ci

# after all machines are upgraded...
isconf lock clean up after upgrade to $newversion
isconf exec rm /var/is/fs/cache/localdomain  
isconf ci

